{% extends "events/base.html" %}

{% block title %}
Create Event
{% endblock %}

{% block extra_styles %}
<style>
    .sticky-note-container {
    width: 500px;  /* Desktop size */
    height: 520px;
    background-color: #a6cff4;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 5px 5px 15px rgba(0,0,0,0.2);
    margin: 0 auto;
}

    @media (max-width: 992px) {
    .sticky-note-container {
        width: 400px;
        height: 600px;
    }
}

.create-event-form label, 
.create-event-form textarea {
    font-size: 2rem;
    margin-top: 15px;
    margin-bottom: 2px;
    font-family: 'Caveat', cursive;
    font-weight: 700
}

#create-event-button {
    margin-top: 15px;
    width: 100%;
}

.banner {
    background-color: #ffffff;  /* Example color; adjust as needed */
    padding: 20px 0;  /* Some padding for top and bottom */
    text-align: center;  /* Center the text or content */
    font-size: 5rem;  /* Increase font size for visibility */

}
</style>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Sedgwick+Ave+Display&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Sedgwick+Ave+Display&display=swap" rel="stylesheet">


{% endblock %}

{% block content %}
<div class="banner">
    <h1>Cheer↑</h1>
</div>


<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <!-- Brand/logo -->
    <a class="navbar-brand" href="#">Cheer↑</a>
    
    <!-- Toggler/collapsible Button -->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    
    <!-- Navbar links -->
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item active">
                <a class="nav-link" href="#">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Find Out Events</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">My events</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Contact</a>
            </li>
        </ul>
    </div>
</nav>

<div class="sticky-note-container mt-5">
    <form action="{% url 'events:save-event' %}" method="post" class="create-event-form">
        {% csrf_token %}
        <fieldset>
            <!-- <legend class="h1">Create an Event</legend> -->
            
            {% if error_message %}
            <div class="alert alert-danger" role="alert">
                {{ error_message }}
            </div>
            {% endif %}
            
            <div class="form-group">
                <label for="event_name">Event Name:</label>
                <input type="text" class="form-control" name="event_name" id="event_name" placeholder="Add Event Name" required>
            </div>

            <div class="row">
                
                <div class="col-md-6 form-group">
                    <label for="start_time">Start Time:</label>
                    <input type="datetime-local" class="form-control" name="start_time" id="start_time" required>
                </div>
                <div class="col-md-6 form-group">
                    <label for="end_time">End Time:</label>
                    <input type="datetime-local" class="form-control" name="end_time" id="end_time" required>
                </div>
            </div>

            <div class="form-group">
                <label for="capacity">Capacity:</label>
                <input type="number" class="form-control" name="capacity" id="capacity" placeholder="Capacity" required>
            </div>

            

            <div class="form-group">
                <input type="hidden" id="selected-location-id" name="event_location_id"> <!-- Hidden input to store the ID -->
                <label for="autocomplete-input">Location:</label>
                <input type="text" class="form-control" name="location" placeholder="Location" id="autocomplete-input" required>
                <ul id="autocomplete-list" class="list-group mt-2"></ul>
            </div>            

            <button type="submit" class="btn btn-primary" id="create-event-button">CREATE MY EVENT</button>
        </fieldset>
    </form>
</div>


{% endblock %}

<!-- HTML -->

{% block extra_scripts %}
<script type="text/javascript">

const input = document.getElementById('autocomplete-input');
        const list = document.getElementById('autocomplete-list');
        const selectedIdInput = document.getElementById('selected-location-id');

        // Replace 'YOUR_API_ENDPOINT' with the actual API endpoint you want to use.
        const API_ENDPOINT = '/locations/autocomplete/?term=';

        input.addEventListener('input', async function () {
            const query = input.value.toLowerCase();
            list.innerHTML = '';

            if (query) {
                try {
                    const response = await fetch(API_ENDPOINT + query);
                    const data = await response.json();

                    data.forEach(function (item) {
                        const listItem = document.createElement('li');
                        listItem.textContent = item.text; // Display the name
                        listItem.addEventListener('click', function () {
                            input.value = item.text; // Set the id as the input field's value
                            selectedIdInput.value = item.id; // Store the ID in the hidden input
                            list.innerHTML = '';
                        });
                        list.appendChild(listItem);
                    });
                } catch (error) {
                    console.error('Error fetching data from the API:', error);
                }
            }
        });

        document.addEventListener('click', function (event) {
            if (event.target !== input) {
                list.innerHTML = '';
            }
        });
</script>
{% endblock %}
